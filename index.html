<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Admin Dashboard - Caraga Dart Knights</title>
  <link rel="stylesheet" href="admin.css">
  <style>
<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #001f3f; /* Dark Blue */
    margin: 0;
    padding: 0;
    color: #ffffff; /* White text */
  }

  header {
    background: #003366;
    color: white;
    padding: 15px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .logo-title {
    display: flex;
    align-items: center;
    gap: 15px;
  }

  .logo {
    height: 60px;
  }

  .title {
    font-size: 1.5em;
  }

  .logout-btn {
    background: #ff4136;
    border: none;
    color: white;
    padding: 10px 15px;
    cursor: pointer;
    font-weight: bold;
  }

  .dashboard-container {
    padding: 20px;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 10px;
    background-color: #002b5c; /* Darker blue for table */
    color: white;
  }

  th, td {
    border: 1px solid #ccc;
    padding: 10px;
    text-align: center;
  }

  th {
    background: #005f73;
    color: white;
  }

  tr:nth-child(even) {
    background-color: #003366;
  }

  .modal {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(0, 0, 0, 0.7);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 999;
  }

  .modal-content {
    background: #004080;
    color: white;
    padding: 20px;
    width: 300px;
    border-radius: 10px;
  }

  .modal-actions {
    margin-top: 10px;
    text-align: right;
  }

  button {
    padding: 8px 12px;
    border: none;
    background-color: #0074D9;
    color: white;
    cursor: pointer;
    border-radius: 4px;
    margin: 5px;
  }

  button:hover {
    background-color: #005fa3;
  }

  input[type="text"],
  input[type="date"],
  input[type="time"] {
    width: 100%;
    padding: 6px;
    margin: 4px 0 10px 0;
    border: 1px solid #ccc;
    border-radius: 4px;
  }
</style>

</head>
<body>

<header>
  <div class="logo-title">
    <img src="images/Itim at Pula E-Sports Naglalarawan Gaming Gaming Logo (1).png" alt="Logo" class="logo" />
    <div class="title">Admin Dashboard</div>
  </div>
  <button class="logout-btn" onclick="logout()">Logout</button>
</header>

<div class="welcome-message" id="welcomeAdmin"></div>

<!-- Match Schedule Section -->
<section class="dashboard-container">
  <h2>Manage Match Schedule</h2>
  <div style="text-align: center;">
    <button onclick="prevMonth()">‚Üê</button>
    <span id="monthYear">Loading...</span>
    <button onclick="nextMonth()">‚Üí</button>
  </div>
  <button onclick="openMatchModal()">‚ûï Add Match</button>
  <table id="matchScheduleTable">
    <thead>
      <tr>
        <th>Date</th>
        <th>Time</th>
        <th>Match</th>
        <th>Location</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</section>

<!-- Match Modal -->
<div id="matchModal" class="modal" style="display:none;">
  <div class="modal-content">
    <h3 id="modalTitle">Add Match</h3>
    <input type="hidden" id="matchIndex" />
    <label>Date:</label><input type="date" id="matchDate" /><br/>
    <label>Time:</label><input type="time" id="matchTime" /><br/>
    <label>Match:</label><input type="text" id="matchTeams" /><br/>
    <label>Location:</label><input type="text" id="matchLocation" /><br/>
    <div class="modal-actions">
      <button onclick="saveMatch()">üíæ Save</button>
      <button onclick="closeMatchModal()">‚ùå Cancel</button>
    </div>
  </div>
</div>

<!-- Match Logs -->
<section class="dashboard-container">
  <h2>Match Logs</h2>
  <div style="text-align: center;">
    <button onclick="changeLogMonth(-1)">‚Üê</button>
    <span id="logMonthYear">Loading...</span>
    <button onclick="changeLogMonth(1)">‚Üí</button>
  </div>
  <button onclick="openLogModal()">‚ûï Add Match Log</button>
  <table>
    <thead>
      <tr>
        <th>Date</th>
        <th>Player</th>
        <th>Opponent</th>
        <th>Winner</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody id="adminMatchLogsTableBody"></tbody>
  </table>
</section>

<!-- Log Modal -->
<div id="logModal" class="modal" style="display:none;">
  <div class="modal-content">
    <h3 id="logModalTitle">Add/Edit Match Log</h3>
    <input type="hidden" id="logIndex" />
    <label>Date:</label><input type="date" id="logDate" /><br/>
    <label>Player:</label><input type="text" id="logPlayer" /><br/>
    <label>Opponent:</label><input type="text" id="logOpponent" /><br/>
    <label>Winner:</label><input type="text" id="logWinner" /><br/>
    <div class="modal-actions">
      <button onclick="addOrUpdateLog()">üíæ Save</button>
      <button onclick="closeLogModal()">‚ùå Cancel</button>
    </div>
  </div>
</div>

<!-- Dummy Sections -->
<section class="dashboard-container">
  <h2>Registered Users</h2>
  <div id="userTableContainer">Coming Soon...</div>

  <h2>Registered Admins</h2>
  <div id="adminTableContainer">Coming Soon...</div>

  <h2>User Login History</h2>
  <div id="userLoginHistoryContainer">Coming Soon...</div>

  <h2>Admin Login History</h2>
  <div id="adminHistoryContainer">Coming Soon...</div>
</section>

<script>
  if (localStorage.getItem("adminLoggedIn") !== "true") {
    window.location.href = "admin-login.html";
  }

  document.getElementById("welcomeAdmin").textContent = `üëë Welcome, Admin!`;

  let currentDate = new Date();

  function renderSchedule() {
    const schedule = JSON.parse(localStorage.getItem("matchSchedule")) || [];
    const tbody = document.querySelector("#matchScheduleTable tbody");
    tbody.innerHTML = "";

    document.getElementById("monthYear").textContent = currentDate.toLocaleString('default', { month: 'long', year: 'numeric' });

    const filtered = schedule.filter(m => {
      const d = new Date(m.date);
      return d.getMonth() === currentDate.getMonth() && d.getFullYear() === currentDate.getFullYear();
    });

    if (filtered.length === 0) {
      tbody.innerHTML = `<tr><td colspan="5">No matches this month.</td></tr>`;
      return;
    }

    filtered.forEach((m, i) => {
      const row = document.createElement("tr");
      row.innerHTML = `
        <td>${m.date}</td>
        <td>${m.time}</td>
        <td>${m.match}</td>
        <td>${m.location}</td>
        <td>
          <button onclick="editMatch(${i})">‚úèÔ∏è</button>
          <button onclick="deleteMatch(${i})">üóëÔ∏è</button>
        </td>
      `;
      tbody.appendChild(row);
    });
  }

  function openMatchModal() {
    document.getElementById("matchModal").style.display = "flex";
    document.getElementById("modalTitle").textContent = "Add Match";
    document.getElementById("matchIndex").value = "";
    document.getElementById("matchDate").value = "";
    document.getElementById("matchTime").value = "";
    document.getElementById("matchTeams").value = "";
    document.getElementById("matchLocation").value = "";
  }

  function closeMatchModal() {
    document.getElementById("matchModal").style.display = "none";
  }

  function saveMatch() {
    const schedule = JSON.parse(localStorage.getItem("matchSchedule")) || [];
    const index = document.getElementById("matchIndex").value;
    const match = {
      date: document.getElementById("matchDate").value,
      time: document.getElementById("matchTime").value,
      match: document.getElementById("matchTeams").value,
      location: document.getElementById("matchLocation").value
    };
    if (index) schedule[index] = match;
    else schedule.push(match);
    localStorage.setItem("matchSchedule", JSON.stringify(schedule));
    closeMatchModal();
    renderSchedule();
  }

  function editMatch(index) {
    const schedule = JSON.parse(localStorage.getItem("matchSchedule")) || [];
    const match = schedule[index];
    document.getElementById("matchIndex").value = index;
    document.getElementById("matchDate").value = match.date;
    document.getElementById("matchTime").value = match.time;
    document.getElementById("matchTeams").value = match.match;
    document.getElementById("matchLocation").value = match.location;
    document.getElementById("modalTitle").textContent = "Edit Match";
    document.getElementById("matchModal").style.display = "flex";
  }

  function deleteMatch(index) {
    const schedule = JSON.parse(localStorage.getItem("matchSchedule")) || [];
    if (confirm("Delete this match?")) {
      schedule.splice(index, 1);
      localStorage.setItem("matchSchedule", JSON.stringify(schedule));
      renderSchedule();
    }
  }

  function prevMonth() {
    currentDate.setMonth(currentDate.getMonth() - 1);
    renderSchedule();
  }

  function nextMonth() {
    currentDate.setMonth(currentDate.getMonth() + 1);
    renderSchedule();
  }

  // MATCH LOGS
  let logCurrentDate = new Date();

  function renderAdminLogs() {
    const logs = JSON.parse(localStorage.getItem("matchLogs")) || [];
    const logBody = document.getElementById("adminMatchLogsTableBody");
    const month = logCurrentDate.getMonth();
    const year = logCurrentDate.getFullYear();

    document.getElementById("logMonthYear").textContent =
      logCurrentDate.toLocaleString("default", { month: "long" }) + " " + year;

    logBody.innerHTML = "";
    const filtered = logs.filter(log => {
      const d = new Date(log.date);
      return d.getMonth() === month && d.getFullYear() === year;
    });

    if (filtered.length === 0) {
      logBody.innerHTML = '<tr><td colspan="5">No logs for this month.</td></tr>';
      return;
    }

    filtered.forEach((log, index) => {
      const row = document.createElement("tr");
      row.innerHTML = `
        <td>${log.date}</td>
        <td>${log.player}</td>
        <td>${log.opponent}</td>
        <td>${log.winner}</td>
        <td>
          <button onclick="editLog(${index})">‚úèÔ∏è</button>
          <button onclick="deleteLog(${index})">üóëÔ∏è</button>
        </td>
      `;
      logBody.appendChild(row);
    });

    localStorage.setItem("matchLogDate", logCurrentDate.toISOString());
  }

  function changeLogMonth(dir) {
    logCurrentDate.setMonth(logCurrentDate.getMonth() + dir);
    renderAdminLogs();
  }

  function openLogModal() {
    document.getElementById("logModal").style.display = "flex";
    document.getElementById("logModalTitle").textContent = "Add Match Log";
    document.getElementById("logIndex").value = "";
    document.getElementById("logDate").value = "";
    document.getElementById("logPlayer").value = "";
    document.getElementById("logOpponent").value = "";
    document.getElementById("logWinner").value = "";
  }

  function closeLogModal() {
    document.getElementById("logModal").style.display = "none";
  }

  function addOrUpdateLog() {
    const logs = JSON.parse(localStorage.getItem("matchLogs")) || [];
    const index = document.getElementById("logIndex").value;
    const log = {
      date: document.getElementById("logDate").value,
      player: document.getElementById("logPlayer").value,
      opponent: document.getElementById("logOpponent").value,
      winner: document.getElementById("logWinner").value,
    };

    if (index) logs[index] = log;
    else logs.push(log);

    localStorage.setItem("matchLogs", JSON.stringify(logs));
    closeLogModal();
    renderAdminLogs();
  }

  function editLog(index) {
    const logs = JSON.parse(localStorage.getItem("matchLogs")) || [];
    const log = logs[index];
    document.getElementById("logIndex").value = index;
    document.getElementById("logDate").value = log.date;
    document.getElementById("logPlayer").value = log.player;
    document.getElementById("logOpponent").value = log.opponent;
    document.getElementById("logWinner").value = log.winner;
    document.getElementById("logModalTitle").textContent = "Edit Match Log";
    document.getElementById("logModal").style.display = "flex";
  }

  function deleteLog(index) {
    if (!confirm("Are you sure you want to delete this log?")) return;
    const logs = JSON.parse(localStorage.getItem("matchLogs")) || [];
    logs.splice(index, 1);
    localStorage.setItem("matchLogs", JSON.stringify(logs));
    renderAdminLogs();
  }

  function logout() {
    localStorage.removeItem("adminLoggedIn");
    localStorage.removeItem("admin");
    window.location.href = "advertisement.html";
  }

  // Initial Rendering
  renderSchedule();
  renderAdminLogs();
</script>

</body>
</html>
